function genParen(n) {
  let combinations = [];

  genString(n, 1, combinations);
  return combinations;
}

function genString(total, insertPos = 1, combinations) {
  let str = "";
  if (total === 0) return str;
  str += "(";
  // if (insertPos === total) {
  //   return str + ")";
  // }
  let minPossible = insertPos === total ? 1 : 0;
  let maxPossible = Math.min(insertPos,total);
  for (let i = minPossible; i <= maxPossible; i++) {
    str +=
      ")".repeat(i);

     str += (insertPos < total
        ? genString(total - i, insertPos + 1, combinations,str)
        : ""
        );
  }

  // insertPos === total && 
  return str;
}

//(((())))()
// console.log(genParen(3));
// console.log(genParen(5));



function generateParenthesis(n, result=[]) {
  if(n===0) return []
  if(n === 1) return ["()"]
  
  const lesser = generateParenthesis(n-1, result);
  let _result = new Set()
  for(let i of lesser){
      // _result.add(i + "()") 
      // _result.add("()"+i)       
      _result.add("("+i+")")
      let idx = 1
      let str = i
      while(idx < str.length){
        if(i[idx] === ')' && i[idx-1] === '(') {
          _result.add(str.substr(0,idx)+"()"+str.substr(idx))
          _result.add(str.substr(0,idx+1)+"()"+str.substr(idx+1))
          _result.add(str.substr(0,idx-1)+"()"+str.substr(idx-1))
        }
        idx++
      }
  }

  return [..._result];
};


function generateParenthesisIterative(n) {
  if (n <= 0) {
    return [""];
  }

  const result = [];
  const queue = [{ str: "", open: 0, close: 0 }];

  while (queue.length > 0) {
    const current = queue.shift();
    const { str, open, close } = current;

    if (str.length === 2 * n) {
      result.push(str);
    } else {
      if (open < n) {
        queue.push({ str: str + "(", open: open + 1, close });
      }
      if (close < open) {
        queue.push({ str: str + ")", open, close: close + 1 });
      }
    }
  }

  return result;
}
//backtracking
function generateParenthesis2(n){
  const result = []

  function buildParenthesis(str, open, close){
    if(open === n && close === n) console.log('open = close = ', n, str)
    if(str.length ===  2 * n) return result.push(str)

    // "("
    if(open < n){
      buildParenthesis(str+"(", open+1, close)
    }
    if(close < open){
      buildParenthesis(str+")",open, close+1)
    }

  }
  buildParenthesis("", 0, 0)
  return result;
}


// expect(generateParenthesis(2)).to.eql(["()()", "(())"].sort());
expect(generateParenthesisIterative(3).sort()).to.eql(["((()))","(()())","(())()","()(())","()()()"].sort()); 
expect(generateParenthesis2(4).sort()).to.eql(["(((())))","((()()))","((())())","((()))()","(()(()))","(()()())","(()())()","(())(())","(())()()","()((()))","()(()())","()(())()","()()(())","()()()()"].sort()); 
// expect(generateParenthesis(5).sort()).to.eql(["((((()))))","(((()())))","(((())()))","(((()))())","(((())))()","((()(())))","((()()()))","((()())())","((()()))()","((())(()))","((())()())","((())())()","((()))(())","((()))()()","(()((())))","(()(()()))","(()(())())","(()(()))()","(()()(()))","(()()()())","(()()())()","(()())(())","(()())()()","(())((()))","(())(()())","(())(())()","(())()(())","(())()()()","()(((())))","()((()()))","()((())())","()((()))()","()(()(()))","()(()()())","()(()())()","()(())(())","()(())()()","()()((()))","()()(()())","()()(())()","()()()(())","()()()()()"].sort()); //['((())(()))', '((()))(())', '(()())(())', '(())((()))', '(())(()())', '(())(())()', '(())()(())', '()(())(())']
// expect(generateParenthesis(6).sort()).to.eql(["(((((())))))","((((()()))))","((((())())))","((((()))()))","((((())))())","((((()))))()","(((()(()))))","(((()()())))","(((()())()))","(((()()))())","(((()())))()","(((())(())))","(((())()()))","(((())())())","(((())()))()","(((()))(()))","(((()))()())","(((()))())()","(((())))(())","(((())))()()","((()((()))))","((()(()())))","((()(())()))","((()(()))())","((()(())))()","((()()(())))","((()()()()))","((()()())())","((()()()))()","((()())(()))","((()())()())","((()())())()","((()()))(())","((()()))()()","((())((())))","((())(()()))","((())(())())","((())(()))()","((())()(()))","((())()()())","((())()())()","((())())(())","((())())()()","((()))((()))","((()))(()())","((()))(())()","((()))()(())","((()))()()()","(()(((()))))","(()((()())))","(()((())()))","(()((()))())","(()((())))()","(()(()(())))","(()(()()()))","(()(()())())","(()(()()))()","(()(())(()))","(()(())()())","(()(())())()","(()(()))(())","(()(()))()()","(()()((())))","(()()(()()))","(()()(())())","(()()(()))()","(()()()(()))","(()()()()())","(()()()())()","(()()())(())","(()()())()()","(()())((()))","(()())(()())","(()())(())()","(()())()(())","(()())()()()","(())(((())))","(())((()()))","(())((())())","(())((()))()","(())(()(()))","(())(()()())","(())(()())()","(())(())(())","(())(())()()","(())()((()))","(())()(()())","(())()(())()","(())()()(())","(())()()()()","()((((()))))","()(((()())))","()(((())()))","()(((()))())","()(((())))()","()((()(())))","()((()()()))","()((()())())","()((()()))()","()((())(()))","()((())()())","()((())())()","()((()))(())","()((()))()()","()(()((())))","()(()(()()))","()(()(())())","()(()(()))()","()(()()(()))","()(()()()())","()(()()())()","()(()())(())","()(()())()()","()(())((()))","()(())(()())","()(())(())()","()(())()(())","()(())()()()","()()(((())))","()()((()()))","()()((())())","()()((()))()","()()(()(()))","()()(()()())","()()(()())()","()()(())(())","()()(())()()","()()()((()))","()()()(()())","()()()(())()","()()()()(())","()()()()()()"].sort());
// console.time('8')
// generateParenthesis(8)
// console.timeEnd('8')